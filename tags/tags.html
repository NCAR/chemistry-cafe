    <!--
    Choose purpose of visit.
    -->
    <div class="btn-group" ng-show="editp==1">
        <label class="btn btn-primary" ng-model="purpose" btn-radio="'createTag'">Create<br>Tag</label>
        <label class="btn btn-primary" ng-model="purpose" btn-radio="'exportTag'">Export<br>Tag</label>
        <label class="btn btn-primary" ng-model="purpose" btn-radio="'branchFromTag'">Create Mechanism<br>From Tag</label>
        <label class="btn btn-primary" ng-model="purpose" btn-radio="'editTag'">Edit Tag<br>Information</label>
        <label class="btn btn-primary" ng-model="purpose" btn-radio="'showMechanisms'">Show<br>Mechanisms</label>
    </div> 
    <br />
    <hr>

    <!--
    Show Mechanisms
    -->
    <div ng-show="purpose=='showMechanisms'">
        <div class="row col-md-12">
            <table class="table table-striped table-bordered" >
            <thead>
                <th >Mechanism Name</th>
                <th >Deprecated/OK</th>
            </thead>
            <tbody> 
            <tr ng-repeat="branch in branchArray">
                <td>{{ branch.name }}</td>
                <td>{{ branch.deprecated ? "Deprecated" : "OK" }}</td>
            </tr> 
            </tbody>
            </table>
        </div> <!-- end of div class row -->
    </div>

    <!--
    Create a Tag on a Mechanism
    -->
    <div ng-show="purpose=='createTag'">
        <form class="form-horizontal">
        <div class ="form-group">
            <label class="control-label col-sm-3">Select Mechanism To Tag:</label>
            <div class="col-sm-3">
                <select class="form-control" name="MechToTag" id="MechToTag" 
                        ng-change="choseBranchOptions(branch)"
                        ng-model="selectedBranch"
                        ng-options="branch as branch.name for branch in branchArray">
                </select>
            </div>
        </div>
        <div ng-show='selectedBranch !== ""'>
            <div class ="form-group">
                <label class="col-sm-3 control-label">Short Tag Description:</label>
                <div class="col-sm-9 ">
                    <input type="text" size=100 
                           ng-model="exportName" 
                           placeholder="Tag TSMLT to create new Trop Mechanism">
                    <br />
                </div>
            </div>
            <div class ="form-group">
                <label class="col-sm-3 control-label"> {{initials}} : {{today | date :'yyyy-MM-dd'}} : </label>
                <div class="col-sm-9 ">
                      <textarea rows="5" cols="50" 
                          ng-model="exportComment"
                          placeholder="Add A Longer Description. Your initials and date will be prepended automatically.">
                      </textarea> <br />
                </div>
            </div>
            <hr>
            <h4> The following are the most recent setting for this mechanism. </h4><h4>They will be printed into the tag file. </h4><h4>Their inclusion are not currently versioned.</h4>
            <hr>
            <div class ="form-group">
                <label class="col-sm-3 control-label"> External (aerosol) Package Species: </label>
                <div ng-show="editPackages=='F'"><button ng-click="editPackages='T'">Edit</button></div>
                <div ng-show="editPackages=='T'"><button ng-click="editPackages='F'">Done</button>
                    <h3>Additional Solution Species (CESM Only) for {{selectedBranch.name}}?</h3>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Include?</th>
                            <th>Name</th>
                            <th>Description</th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="external in associated.externals">
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleIncludeInExternal(external)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="external.externals">
                            </td>
                            <td>{{ external.name }}</td>
                            <td>{{ external.description}}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div> 
                </div>
            </div> <!-- end of External Packages -->
            <div class ="form-group">
                <label class="col-sm-3 control-label"> Species-level Diagnostics: </label>
                <div ng-show="editSDiags=='F'"><button ng-click="editSDiags='T'">Edit</button></div>
                <div ng-show="editSDiags=='T'"><button ng-click="editSDiags='F'">Done</button>
                    <h3>Species-level Diagnostics for {{selectedBranch.name}}?</h3>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Include in <br> CESM Nameslist?</th>
                            <th>Include in <br> WRF Reaction Products?</th>
                            <th>Name</th>
                            <th>Description</th>
                        </thead>

                        <tbody>
                        <tr ng-repeat="sdiag in associated.sdiags">
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleIncludeSDiag(sdiag)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="sdiag.sdiags">
                            </td>
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleIncludeWrfSDiag(sdiag)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="sdiag.wrf_sdiags">
                            </td>
                            <td>{{ sdiag.sdname }}</td>
                            <td>{{sdiag.m1name}}{{sdiag.f1name}}:{{sdiag.m2name}}{{sdiag.f2name}}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div> 
                </div>
            </div> <!-- end of Species-Level Diags -->
            <div class ="form-group">
                <label class="col-sm-3 control-label"> Reaction-level Diagnostics: </label>
                <div ng-show="editRDiags=='F'"><button ng-click="editRDiags='T'">Edit</button></div>
                <div ng-show="editRDiags=='T'"><button ng-click="editRDiags='F'">Done</button>
                    <h3>Reaction-level Diagnostics for {{selectedBranch.name}}?</h3>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Include In CESM<br>Reaction Products</th>
                            <th>Name</th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="rdiag in associated.rdiags">
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleIncludeRDiag(rdiag)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="rdiag.rdiags">
                            </td>
                            <td>{{ rdiag.name }}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div> <!-- end of Reaction-level Diags -->
            <div class ="form-group">
                <label class="col-sm-3 control-label">CESM Fixed Species: </label>
                <div ng-show="editFixed=='F'"><button ng-click="editFixed='T'">Edit</button></div>
                <div ng-show="editFixed=='T'"><button ng-click="editFixed='F'">Done</button>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Fixed in<br> {{selectedBranch.name}}</th>
                            <th>Name</th>
                            <th>Description</th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="specie in associated.fixed">
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleFixed(specie)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="specie.fixed">
                            </td>
                            <td>{{ specie.name }}</td>
                            <td>{{ specie.description }}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div> <!-- end of Fixed -->
            <div class ="form-group">
                <label class="col-sm-3 control-label">CESM Non Transported Species: </label>
                <div ng-show="editNottransported=='F'"><button ng-click="editNottransported='T'">Edit</button></div>
                <div ng-show="editNottransported=='T'"><button ng-click="editNottransported='F'">Done</button>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Transport in<br> {{selectedBranch.name}}</th>
                            <th>Name</th>
                            <th>Description</th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="specie in associated.nottransported">
                            <td>
                                <input type = "checkbox" 
                                    ng-click="toggleNottransported(specie)" 
                                    ng-true-value="'T'" ng-false-value="'F'"
                                    ng-model="specie.nottransported">
                            </td>
                            <td>{{ specie.name }}</td>
                            <td>{{ specie.description }}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div> <!-- end of Not-transported -->

            <div class ="form-group">
                <label class="col-sm-3 control-label"> Externally-forced Species: </label>
                <div ng-show="editExtforcing=='F'"><button ng-click="editExtforcing='T'">Edit</button></div>
                <div ng-show="editExtforcing=='T'"><button ng-click="editExtforcing='F'">Done</button>
                    <div class="row col-md-12">
                        <table class="table table-striped table-bordered" >
                        <thead>
                            <th>Fixed in<br> {{selectedBranch.name}}</th>
                            <th>Name</th>
                            <th>Description</th>
                        </thead>
                        <tbody>
                        <tr ng-repeat="specie in associated.extforcing">
                            <td>
                               <select class="form-control" name="Forcing" id="Forcing" ng-change="toggleExtforcing(specie)"ng-model="specie.extforcing">
                                   <option value="" disabled="disabled">Not Specified</option>
                                   <option value="None">None</option>
                                   <option value="File">Data File</option>
                                   <option value="Code">In Code</option>
                               </select>
                            <td>{{ specie.name }}</td>
                            <td>{{ specie.description }}</td>
                        </tr>
                        </tbody>
                        </table>
                    </div>
                </div>
            </div> <!-- end of Externally-forced -->





        </div>
        </form>
        <button class="btn btn-success" ng-click="reset()">Cancel</button>
        <button class="btn btn-success" ng-click="createTag()">Create</button>
        <hr>
    </div>

    <!--
    Create Mechanism From Tag
    -->
    <div ng-show="(purpose == 'branchFromTag') && (sourceTag.given_name)">
        <form class="form-horizontal">
        <div class ="form-group">
            <label class="col-sm-3 control-label">Source Tag:</label>
            <div class="col-sm-9 ">{{sourceTag.given_name}} </div>
        </div>
        <div class ="form-group">
            <label class="col-sm-3 control-label">Your Name for the New Mechanism:</label>
            <div class="col-sm-9 ">
                <input type="text" size=100 ng-model="newBranchName" placeholder="(No spaces or special chars, _ is OK) Your New Mechanism Name"><br />
            </div>
        </div>
        <button class="btn btn-success" ng-click="reset()">Cancel</button>
        <button class="btn btn-success" ng-click="createBranchFromTag(sourceTag.id)">Create</button>
        </form>
        <hr>
    </div>

    <!--
    Modify user-specified information about Tag
    -->
    <div ng-show="(purpose == 'editTag') && (sourceTag)">
        <form class="form-horizontal">
        <div class ="form-group">
            <label class="col-sm-3 control-label">Your name for the tag:</label>
            <div class="col-sm-9 ">
                <input type="text" size=100 ng-model="givenName" placeholder="Your name for the Tag">
            </div>
        </div>
        <div class ="form-group">
            <label class="col-sm-3 control-label">Buggy</label>
            <div class="col-sm-9 ">
                <input type="checkbox" ng-model="buggy"> </input>{{buggy}}
            </div>
        </div>
        <div class ="form-group">
            <label class="col-sm-3 control-label"> {{initials}} : {{today | date :'yyyy-MM-dd'}} : </label>
            <div class="col-sm-9 ">
                  <textarea rows="5" cols="50" ng-model="newComment"
                  placeholder="Add A Comment. Your initials and date will be prepended automatically.">
                  </textarea> <br />
            </div>
        </div>
        <button class="btn btn-success" ng-click="reset()">Cancel</button>
        <button class="btn btn-success" ng-click="modifyTag()">Modify</button><br>
       {{initials}} : {{today | date :'yyyy-MM-dd'}} : {{newComment}}<br>
        <span ng-show ="(purpose == 'editTag') && (sourceTag)" ng-repeat="comment in sourceTag.previousComments track by $index">{{comment}}<br></span>
        </form>
        <hr>
    </div>


    <!--
    Display Tags      
    -->
    <div >
            <p> Filter </p>
            <input type="text" ng-model="name_filter" ng-change="filter()" placeholder="Something Contains This String" >
            <h6 align="left">Showing {{ filtered.length }}/{{ tagArray.length }} of the Reactions in the Database</h4>
        <br/>
        <div class="row">
        <div class="col-md-12">
            <table class="table table-striped table-bordered" >
            <thead>
                <th ng-show="purpose == 'exportTag'">Export</th>
                <th ng-show="purpose == 'branchFromTag'">Create<br>Mechanism</th>
                <th ng-show="purpose == 'editTag'">Tag<br>Info</th>
                <th >Short Tag Description</th>
                <th >Tag Name</th>
                <th >Buggy<br>OK</th>
                <th >Source<br>Mechanism</th>
                <th >Tagger</th>
                <th >Date Created</th>
            </thead>
            <tbody> 
            <tr ng-repeat="tag in filtered 
                            = (tagArray
                            | filter:name_filter) ">
<!--
                            | orderBy : predicate :reverse) ">
-->
                <td ng-show="purpose == 'exportTag'">
                    <button type = "submit" 
                        ng-click="exportTag(tag.id)" >
                        Export
                    </button>
                </td>
                <td ng-show="purpose == 'branchFromTag'">
                    <button type = "button" 
                        ng-click="populateBranchFromTagForm(tag)" >
                        Create
                    </button>
                </td>
                <td ng-show="purpose == 'editTag'">
                    <button type = "button" 
                        ng-click="populateEditTagForm(tag)" >
                        Info
                    </button>
                </td>
                <td>{{ tag.given_name }}</td>
                <td>{{ tag.filename }}</td>
                <td>{{ tag.buggy ? "Buggy" : "OK"}}</td>
                <td>{{ tag.branchname }}</td>
                <td>{{ tag.initials }}</td>
                <td>{{ tag.date | date :'yyyy-MM-dd'}}</td>
            </tr> 
            </tbody>
            </table>
        </div> <!-- end of div class col-md-12 -->
        <div class="col-md-12" ng-show="filteredItems == 0"> 
            <h4>Tags loading.... </h4> 
        </div> <!-- end of div class row -->
    </div>  <!-- ng-show -->
    </div>  <!-- ng-show -->


